import { sendingCaso } from  './../redux/actions/AdmissionAction';
import Axios from "axios";

const getToken = async() => {
    const result = await Axios.post(window.REACT_APP_ADMISION+'GenerarTokenTests', {
          "key": "791c9419-b1d7-4002-80bc-a1eedf461ccd",
          "secret": "46d14424-69e7-4d9f-88ad-314cb3183816"
      });
    return result.data.token
}

describe("Crear Casos",()=>{
  
    it("Probar caso tipo trabajo",async()=>{
        //json con error --  comuna siniestro NUNOA (comunaSiniestro)
         const resultado =  await sendingCaso({"id_tipo":1,"id_estado":2,"rut_paciente":"15.004.438-3","mail_admisionista":"onunezc@ext.achs.cl","admision_json":{"percentage":3703.703703703704,"rut":"15.004.438-3","isAfiliado":"Si","empresa":"","rutEmpresa":"70360100-6","isapreSeleccionado":{"id":"2000133146","nombre":"CRUZ BLANCA"},"lugarAccidente":"....................","objetoAccidente":"....................","descripcionAccidente":"....................","relatoAccidente":"Al momento del accidente estaba ..................... Lo que ocurrió fue que ..................... El accidente ocurrió con .....................","volverAConcatenar":false,"testigos":{"nombre":"","cargo":""},"responsable":{"nombre":"","cargo":""},"fechaHoraResponsable":{},"fechaHoraSiniestro":{"days":18,"month":1,"year":2021,"horas":10,"minutos":42},"fechaHoraAtencion":{},"SucursalEmpresa":"","DireccionEmpresa":"AVDA.GRECIA480","comunaEmpresa":"","direccionParticular":"BLANCO GARCES 41, ESTACION CENTRAL","telefonoParticular":"+56 9 3772 1849","inicioJornadaLaboral":"9:30","finJornadaLaboral":"18:30","ingresoTrabajoActual":"2020-01-01T03:00:00.000Z","desarrollarTrabajoHabitual":"Si","tipoRemuneracion":{"id":1,"nombre":"Salario Fijo","selected":true},"tipoDeContrato":{"id":1,"nombre":"Indefinido","selected":true},"cargoForm":"Ingeniero","sucursalEmpresaSiniestro":{"description":"Avenida Grecia 480, Ñuñoa, Chile","matched_substrings":[{"length":18,"offset":0}],"place_id":"EiJBdmVuaWRhIEdyZWNpYSA0ODAsIMORdcOxb2EsIENoaWxlIjESLwoUChIJr-CMt2PFYpYRCHQXerdLuykQ4AMqFAoSCSvs1urSz2KWEZgRKCj20O9K","reference":"EiJBdmVuaWRhIEdyZWNpYSA0ODAsIMORdcOxb2EsIENoaWxlIjESLwoUChIJr-CMt2PFYpYRCHQXerdLuykQ4AMqFAoSCSvs1urSz2KWEZgRKCj20O9K","structured_formatting":{"main_text":"Avenida Grecia 480","main_text_matched_substrings":[{"length":18,"offset":0}],"secondary_text":"Ñuñoa, Chile"},"terms":[{"offset":0,"value":"Avenida Grecia 480"},{"offset":20,"value":"Ñuñoa"},{"offset":27,"value":"Chile"}],"types":["street_address","geocode"]},"urlMapasucursalEmpresaSiniestro":"https://qa.salud.achs.cl/orquestador/api/geo/getMapaEstatico?id=EiJBdmVuaWRhIEdyZWNpYSA0ODAsIMORdcOxb2EsIENoaWxlIjESLwoUChIJr-CMt2PFYpYRCHQXerdLuykQ4AMqFAoSCSvs1urSz2KWEZgRKCj20O9K&size=300x280","SucursalEmpresaObjeto":{"sucursalCargo":"0000000151","codigo":151,"nombre":"","id_comuna":"101","comuna":"ANTOFAGASTA","codigo_region":2,"region":"II - Antofagasta","direccion":"AVDA.GRECIA480","latitud":"-23.500000000000","longitud":"-69.000000000000"},"centrosForm":{"id":76,"Centro_m":"Santiago","UO_Medica":"STGMAPRI","UO_Tratamiento":"STGTCAPR"},"siniestroDetalle":{},"siniestroOpciones":{"mensajeAlerta":"Este paciente ya tiene un siniestro","mensajeBoton":"Ver su(s) siniestro(s)","origen":"getRut"},"tipoSiniestro":{"Id":1,"Descripcion":"Accidente Trabajo"},"DireccionTemporal":{},"LatTemporal":"","LongTemporal":"","AccidenteEnSucursal":"Si","sucursalCargo":"0000000151","comunaSiniestro":"NUNOA","comunaDireccionParticular":" ESTACION CENTRAL","BP":"1002615349","mensajeErrorSAP":"","TrabajadorIndependiente":"","tab":0,"coberturaSoap":"no","CamposDocumentos":{"anteceContr":"","FechaOtroRe":"","HoraOtroRec":"","OtroRecinto":"","OtroRecintoSi":"","OtroRecintoNo":"x","CuentaConSi":"","CuentaConNo":"x","CuentaCual":"","DatosTestig":"","Mecanismo":"","PosibleCaus":"","MedioTransp":"","Otras":"","avisoPresen":"","avisoMail":"","avisoFono":"","avisoOtro":"","avisoCual":"","antecePartP":"","anteceConst":"","anteceVideS":"","anteceComSe":"","anteceOtro":"","anteceOtroC":"","anteceNocuenta":"x","anteceRespA":"","anteceRespO":"","anteceRegsA":"","anteceCertH":"","TestigoS":"","TestigoN":"x"},"FechaSintomasEP":{},"AgenteCausaEP":{},"TipoAvisoResponsable":{},"usuarioSAP":"SADIAZG","datosAdicionalesSAP":{"apellidoMaterno":"GARECAAAA","apellidoPaterno":"DIAZZZ","nombre":"SERGIO ANDRESSS","fechaNacimiento":"1982-09-07","masculino":"X","femenino":"","nacionalidad":"AR","estadoCivil":"1"},"razonSocial":{"bp":"2000462553","name":"ASOCIACIÓN CHILENA DE SEGURIDAD","rut":"70360100-6"},"cantidadSucursales":1,"comunaSucursal":{"id":86,"codigo_region":2,"codigo_comuna":"101","nombre":"ANTOFAGASTA"},"sucursales":[{"sucursalCargo":"0000000151","codigo":151,"nombre":"","id_comuna":"101","comuna":"ANTOFAGASTA","codigo_region":2,"region":"II - Antofagasta","direccion":"AVDA.GRECIA480","latitud":"-23.500000000000","longitud":"-69.000000000000"}],"codigoSucursal":151,"relatoAccidenteTemporal":"Al momento del accidente estaba ..................... Lo que ocurrió fue que ..................... El accidente ocurrió con .....................","lugarReferenciaSiniestro":"....................","afpForm":{"codigo":"001","nombre":"1 - CAPITAL","selected":true},"profesionForm":{"codigo":2149,"nombre":"Ingeniero(a)"},"tipoJornadaForm":{"id":"1","nombre":"Lunes a Viernes","key":"","selected":true},"categoriaOcupacionalForm":{"id":2,"nombre":"Asalariados","selected":true},"emailusuario":"notienecorreo@achs.cl"},"telefono_paciente":"+56 9 3772 1849","email_paciente":"notienecorreo@achs.cl"},await getToken())
       
         console.log("Resultado",resultado.data?resultado.data:resultado)
         expect(resultado.data.content[0].IdEstadoAdmision).toEqual(3)
         expect(resultado.data.content[0].IdEstadoSiniestro).toEqual(6)
    })
    it("Probar caso tipo trayecto",async()=>{
        //json con error --  comuna siniestro NUNOA (comunaSiniestro)
         const resultado =  await sendingCaso({"id_tipo":1,"id_estado":2,"rut_paciente":"15.004.438-3","mail_admisionista":"onunezc@ext.achs.cl","admision_json":{"percentage":3703.703703703704,"rut":"15.004.438-3","isAfiliado":"Si","empresa":"","rutEmpresa":"70360100-6","isapreSeleccionado":{"id":"2000133146","nombre":"CRUZ BLANCA"},"lugarAccidente":".................","objetoAccidente":".................","descripcionAccidente":".................","relatoAccidente":"Al momento del accidente estaba .................. Lo que ocurrió fue que .................. El accidente ocurrió con ..................","volverAConcatenar":false,"testigos":{"nombre":"","cargo":""},"responsable":{"nombre":"","cargo":""},"fechaHoraResponsable":{},"fechaHoraSiniestro":{"days":18,"month":1,"year":2021,"horas":11,"minutos":27},"fechaHoraAtencion":{},"SucursalEmpresa":"","DireccionEmpresa":"AVDA.GRECIA480","comunaEmpresa":"","direccionParticular":"BLANCO GARCES 41, ESTACION CENTRAL","telefonoParticular":"+56 9 3772 1849","inicioJornadaLaboral":"9:30","finJornadaLaboral":"18:30","ingresoTrabajoActual":"2020-01-01T03:00:00.000Z","desarrollarTrabajoHabitual":"no","tipoRemuneracion":{"id":1,"nombre":"Salario Fijo","selected":true},"tipoDeContrato":{"id":1,"nombre":"Indefinido","selected":true},"cargoForm":"asdfasdf","sucursalEmpresaSiniestro":{"description":"Manuel Antonio Tocornal 2359, San Joaquín, Región Metropolitana, Chile","place_id":"ChIJMxlTVUXFYpYRt_13vGybUgk","reference":"ChIJMxlTVUXFYpYRt_13vGybUgk","structured_formatting":{"main_text":"Manuel Antonio Tocornal 2359","secondary_text":" San Joaquín,  Región Metropolitana"},"types":["street_address","geocode"]},"urlMapasucursalEmpresaSiniestro":"https://qa.salud.achs.cl/orquestador/api/geo/getMapaEstatico?id=ChIJMxlTVUXFYpYRt_13vGybUgk&size=300x280","SucursalEmpresaObjeto":{"sucursalCargo":"0000000151","codigo":151,"nombre":"","id_comuna":"101","comuna":"ANTOFAGASTA","codigo_region":2,"region":"II - Antofagasta","direccion":"AVDA.GRECIA480","latitud":"-23.500000000000","longitud":"-69.000000000000"},"centrosForm":{"id":76,"Centro_m":"Santiago","UO_Medica":"STGMAPRI","UO_Tratamiento":"STGTCAPR"},"siniestroDetalle":{},"siniestroOpciones":{"mensajeAlerta":"Este paciente ya tiene un siniestro","mensajeBoton":"Ver su(s) siniestro(s)","origen":"getRut"},"tipoSiniestro":{"Id":2,"Descripcion":"Accidente Trayecto"},"DireccionTemporal":{},"LatTemporal":"","LongTemporal":"","AccidenteEnSucursal":"no","sucursalCargo":"0000000151","comunaSiniestro":"NUNOA","comunaDireccionParticular":" ESTACION CENTRAL","BP":"1002615349","mensajeErrorSAP":"","TrabajadorIndependiente":"","tab":0,"coberturaSoap":"no","CamposDocumentos":{"anteceContr":"","FechaOtroRe":"","HoraOtroRec":"","OtroRecinto":"","OtroRecintoSi":"","OtroRecintoNo":"x","CuentaConSi":"","CuentaConNo":"x","CuentaCual":"","DatosTestig":"","Mecanismo":".................","PosibleCaus":".................","MedioTransp":"Metro","Otras":".................","avisoPresen":"","avisoMail":"","avisoFono":"","avisoOtro":"","avisoCual":"","antecePartP":"","anteceConst":"","anteceVideS":"","anteceComSe":"","anteceOtro":"","anteceOtroC":"","anteceNocuenta":"x","anteceRespA":"","anteceRespO":"","anteceRegsA":"","anteceCertH":"","TestigoS":"","TestigoN":"x","ParteAfecta":"Pierna y rodilla derechas"},"FechaSintomasEP":{},"AgenteCausaEP":{},"TipoAvisoResponsable":{},"usuarioSAP":"SADIAZG","datosAdicionalesSAP":{"apellidoMaterno":"GARECAAAA","apellidoPaterno":"DIAZZZ","nombre":"SERGIO ANDRESSS","fechaNacimiento":"1982-09-07","masculino":"X","femenino":"","nacionalidad":"AR","estadoCivil":"1"},"razonSocial":{"bp":"2000462553","name":"ASOCIACIÓN CHILENA DE SEGURIDAD","rut":"70360100-6"},"cantidadSucursales":1,"comunaSucursal":{"id":86,"codigo_region":2,"codigo_comuna":"101","nombre":"ANTOFAGASTA"},"sucursales":[{"sucursalCargo":"0000000151","codigo":151,"nombre":"","id_comuna":"101","comuna":"ANTOFAGASTA","codigo_region":2,"region":"II - Antofagasta","direccion":"AVDA.GRECIA480","latitud":"-23.500000000000","longitud":"-69.000000000000"}],"codigoSucursal":151,"tipoAccidenteTrayectoForm":{"key":"2","value":"Entre dos Trabajos","selected":true},"tipoAccTrayecto":"2","relatoAccidenteTemporal":"Al momento del accidente estaba .................. Lo que ocurrió fue que .................. El accidente ocurrió con ..................","lugarReferenciaSiniestro":".................","sucursalEmpresaDiaSiniestroTrayecto":{"description":"Avenida Grecia 480, Ñuñoa, Chile","matched_substrings":[{"length":18,"offset":0}],"place_id":"EiJBdmVuaWRhIEdyZWNpYSA0ODAsIMORdcOxb2EsIENoaWxlIjESLwoUChIJr-CMt2PFYpYRCHQXerdLuykQ4AMqFAoSCSvs1urSz2KWEZgRKCj20O9K","reference":"EiJBdmVuaWRhIEdyZWNpYSA0ODAsIMORdcOxb2EsIENoaWxlIjESLwoUChIJr-CMt2PFYpYRCHQXerdLuykQ4AMqFAoSCSvs1urSz2KWEZgRKCj20O9K","structured_formatting":{"main_text":"Avenida Grecia 480","main_text_matched_substrings":[{"length":18,"offset":0}],"secondary_text":"Ñuñoa, Chile"},"terms":[{"offset":0,"value":"Avenida Grecia 480"},{"offset":20,"value":"Ñuñoa"},{"offset":27,"value":"Chile"}],"types":["street_address","geocode"]},"urlMapaSucursalDiaSiniestroTrayecto":"https://qa.salud.achs.cl/orquestador/api/geo/getMapaEstatico?id=EiJBdmVuaWRhIEdyZWNpYSA0ODAsIMORdcOxb2EsIENoaWxlIjESLwoUChIJr-CMt2PFYpYRCHQXerdLuykQ4AMqFAoSCSvs1urSz2KWEZgRKCj20O9K&size=300x280","comunaDiaSiniestroTrayecto":"ÑUÑOA","afpForm":{"codigo":"003","nombre":"3 - HABITAT","selected":true},"profesionForm":{"codigo":8332,"nombre":"Conductor(a)"},"tipoJornadaForm":{"id":"1","nombre":"Lunes a Viernes","key":"","selected":true},"categoriaOcupacionalForm":{"id":2,"nombre":"Asalariados","selected":true},"emailusuario":"notienecorreo@achs.cl"},"telefono_paciente":"+56 9 3772 1849","email_paciente":"notienecorreo@achs.cl"},await getToken())
       
         console.log("Resultado",resultado.data?resultado.data:resultado)
         expect(resultado.data.content[0].IdEstadoAdmision).toEqual(3)
         expect(resultado.data.content[0].IdEstadoSiniestro).toEqual(6)
    })
    it("Probar caso tipo EP",async()=>{
        //json con error -- incio jornada erronea 45:30 (horario_inicio)
         const resultado =  await sendingCaso({"id_tipo":1,"id_estado":2,"rut_paciente":"15.004.438-3","mail_admisionista":"onunezc@ext.achs.cl","admision_json":{"percentage":3703.703703703704,"rut":"15.004.438-3","isAfiliado":"Si","empresa":"","rutEmpresa":"70360100-6","isapreSeleccionado":{"id":"2000133146","nombre":"CRUZ BLANCA"},"lugarAccidente":"","objetoAccidente":"","descripcionAccidente":"","relatoAccidente":"","volverAConcatenar":false,"testigos":{"nombre":"","cargo":""},"responsable":[],"fechaHoraResponsable":{},"fechaHoraSiniestro":{},"fechaHoraAtencion":{},"SucursalEmpresa":"","DireccionEmpresa":"AVDA.GRECIA480","comunaEmpresa":"","direccionParticular":"BLANCO GARCES 41, ESTACION CENTRAL","telefonoParticular":"+56 9 3772 1849","inicioJornadaLaboral":"45:30","finJornadaLaboral":"18:30","ingresoTrabajoActual":"2020-01-01T03:00:00.000Z","desarrollarTrabajoHabitual":"","tipoRemuneracion":{"id":1,"nombre":"Salario Fijo","selected":true},"tipoDeContrato":{"id":3,"nombre":"Por obra o Faena","selected":true},"cargoForm":"...............","sucursalEmpresaSiniestro":"","urlMapasucursalEmpresaSiniestro":"","SucursalEmpresaObjeto":{"sucursalCargo":"0000000151","codigo":151,"nombre":"","id_comuna":"101","comuna":"ANTOFAGASTA","codigo_region":2,"region":"II - Antofagasta","direccion":"AVDA.GRECIA480","latitud":"-23.500000000000","longitud":"-69.000000000000"},"centrosForm":{"id":76,"Centro_m":"Santiago","UO_Medica":"STGMAPRI","UO_Tratamiento":"STGTCAPR"},"siniestroDetalle":{},"siniestroOpciones":{"mensajeAlerta":"Este paciente ya tiene un siniestro","mensajeBoton":"Ver su(s) siniestro(s)","origen":"getRut"},"tipoSiniestro":{"Id":3,"Descripcion":"Enfermedad Profesional"},"DireccionTemporal":{},"LatTemporal":"","LongTemporal":"","AccidenteEnSucursal":"","sucursalCargo":"0000000151","comunaSiniestro":"","comunaDireccionParticular":" ESTACION CENTRAL","BP":"1002615349","mensajeErrorSAP":"","TrabajadorIndependiente":"","tab":0,"coberturaSoap":"","CamposDocumentos":{"anteceContr":"","FechaOtroRe":"","HoraOtroRec":"","OtroRecinto":"","OtroRecintoSi":"","OtroRecintoNo":"x","CuentaConSi":"","CuentaConNo":"x","CuentaCual":"","DatosTestig":"","Mecanismo":"","PosibleCaus":"","MedioTransp":"","Otras":"","avisoPresen":"","avisoMail":"","avisoFono":"","avisoOtro":"","avisoCual":"","antecePartP":"","anteceConst":"","anteceVideS":"","anteceComSe":"","anteceOtro":"","anteceOtroC":"","anteceNocuenta":"x","anteceRespA":"","anteceRespO":"","anteceRegsA":"","anteceCertH":"","TestigoS":"","TestigoN":"x"},"FechaSintomasEP":{"days":18,"month":1,"year":2021},"AgenteCausaEP":"00000000000000000004","TipoAvisoResponsable":{},"usuarioSAP":"SADIAZG","datosAdicionalesSAP":{"apellidoMaterno":"GARECAAAA","apellidoPaterno":"DIAZZZ","nombre":"SERGIO ANDRESSS","fechaNacimiento":"1982-09-07","masculino":"X","femenino":"","nacionalidad":"AR","estadoCivil":"1"},"razonSocial":{"bp":"2000462553","name":"ASOCIACIÓN CHILENA DE SEGURIDAD","rut":"70360100-6"},"cantidadSucursales":1,"comunaSucursal":{"id":86,"codigo_region":2,"codigo_comuna":"101","nombre":"ANTOFAGASTA"},"sucursales":[{"sucursalCargo":"0000000151","codigo":151,"nombre":"","id_comuna":"101","comuna":"ANTOFAGASTA","codigo_region":2,"region":"II - Antofagasta","direccion":"AVDA.GRECIA480","latitud":"-23.500000000000","longitud":"-69.000000000000"}],"codigoSucursal":151,"molestiaEP":"...............","parteAfectadaEP":"...............","molestiasAnterioresEP":"no","TrabajoMolestiasEP":"...............","FechaExposicionAgenteEP":{"days":18,"month":1,"year":2021},"mismasMolestiasCompañerosEP":"no","afpForm":{"codigo":"001","nombre":"1 - CAPITAL","selected":true},"profesionForm":{"codigo":8332,"nombre":"Conductor(a)"},"tipoJornadaForm":{"id":"1","nombre":"Lunes a Viernes","key":"","selected":true},"categoriaOcupacionalForm":{"id":2,"nombre":"Asalariados","selected":true},"emailusuario":"notienecorreo@achs.cl"},"telefono_paciente":"+56 9 3772 1849","email_paciente":"notienecorreo@achs.cl"},await getToken())
       
         console.log("Resultado",resultado.data?resultado.data:resultado)
         expect(resultado.data.content[0].IdEstadoAdmision).toEqual(3)
         expect(resultado.data.content[0].IdEstadoSiniestro).toEqual(6)
    })
})

